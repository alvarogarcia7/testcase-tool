# Test Case: API Response Validation
# API_03 - Test complex curl commands without escaping

testcase_id: "X20_I1_TC1"

metadata:
  tags:
    - "api"
    - "integration"
  categories:
    - "rest-api"

description: |
  Demonstrates how to write shell commands without escaping quotes,
  brackets, or special characters.

prerequisites:
  - "API server is running"

commands:
  - step: 1
    description: "Simple command - no escaping needed"
    commands:
      - docker ps -a
      - echo "Hello World"

  - step: 2
    description: "POST request with JSON - use literal block"
    commands:
      - |
        curl -X POST http://localhost:8080/api/users \
          -H "Content-Type: application/json" \
          -H "Authorization: Bearer ${TOKEN}" \
          -d '{
            "name": "John Doe",
            "email": "john@example.com",
            "roles": ["admin", "user"]
          }'
    expected_status: 0
    expected_output: ""

  - step: 3
    description: "Commands with pipes and redirects"
    commands:
      - cat /var/log/app.log | grep ERROR | tail -n 10
      - ps aux | grep python | awk '{print $2}'

  - step: 4
    description: "Bash script with conditions"
    commands:
      - |
        if [ -f /tmp/test.txt ]; then
          echo "File exists"
        else
          echo "File not found"
        fi
      - test -d /var/data && echo "Directory exists" || echo "Not found"

verification_commands:
  - description: "Verify response contains token"
    commands:
      - |
        ssh << 'EOF'
        echo $RESPONSE | jq -r '.token'
        hello
        exit
        EOF

results:
  expected:
    description: |
      All commands should execute successfully without syntax errors.

  actual:
    log_file: "X20_1.actual.log"
    execution_date: "2025-01-15T14:23:45Z"
    executed_by: "qa-automation"
    environment: "staging"
    summary:
      overall_status: "PASS"

verification:
  status: "PASS"
  comments: |
    Test passed successfully. User authenticated and received valid token.

  executed_by: "qa-verication"
  execution_date: "2025-01-15T14:23:45Z"
  environment: "staging"
  issues: []
  notes: ""
